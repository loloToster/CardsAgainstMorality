<script setup lang="ts">
import { reactive } from "vue"

const emit = defineEmits<{ (ev: "change", liked: boolean): void }>()
const props = defineProps<{ liked: boolean }>()
const state = reactive({ liked: props.liked })

function handleClick() {
  state.liked = !state.liked
  emit("change", state.liked)
}
</script>

<template>
  <button
    @click="handleClick"
    class="like"
    :class="{ active: state.liked }"
    v-tooltip="state.liked ? 'Remove from favourites' : 'Add to favourites'"
  >
    <svg
      v-if="state.liked"
      class="like__filled"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 96 960 960"
    >
      <path
        d="m479.761 943.131-45.065-40.587q-106.718-97.718-176.077-168.696-69.358-70.978-110.597-126.957-41.24-55.978-57.74-101.576-16.5-45.598-16.5-92.315 0-92.63 62.174-154.924 62.174-62.294 153.805-62.294 56.761 0 105.141 26.283 48.381 26.283 84.859 76.326 42.478-53.043 89.239-77.826 46.761-24.783 100.761-24.783 91.869 0 154.163 62.294Q886.218 320.37 886.218 413q0 46.717-16.5 92.196-16.5 45.478-57.74 101.456-41.239 55.978-110.717 127.076-69.478 71.098-176.196 168.816l-45.304 40.587Z"
      />
    </svg>
    <svg
      v-else
      xmlns="http://www.w3.org/2000/svg"
      class="like__outlined"
      viewBox="0 96 960 960"
    >
      <path
        d="m479.761 943.131-45.065-40.587Q328.21 804.705 258.735 733.787q-69.474-70.917-110.713-126.896-41.24-55.978-57.74-101.576-16.5-45.598-16.5-92.338 0-92.802 62.212-154.998 62.212-62.197 153.767-62.197 56.83 0 105.176 26.283 48.346 26.283 84.824 76.326 42.478-53.043 89.247-77.826 46.769-24.783 100.753-24.783 91.961 0 154.209 62.204Q886.218 320.189 886.218 413q0 46.71-16.5 92.192-16.5 45.482-57.74 101.46-41.239 55.978-110.801 127.043-69.562 71.064-176.112 168.849l-45.304 40.587Zm-.12-89.761q101.117-92.996 166.26-159.139 65.142-66.144 103.403-115.785 38.261-49.642 53.522-88.454 15.261-38.812 15.261-76.842 0-65.193-41.489-107.215-41.488-42.022-106.496-42.022-50.923 0-94.415 31.62-43.491 31.619-70.491 88.38h-51.631q-25.94-56-69.63-88t-94.36-32q-64.684 0-106.053 41.868-41.37 41.868-41.37 107.535 0 38.466 15.366 77.744t53.642 89.392q38.275 50.113 103.677 115.754 65.402 65.642 164.804 157.164Zm.598-294.848Z"
      />
    </svg>
    <svg
      v-if="state.liked"
      class="like__break"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 96 960 960"
    >
      <path
        d="M478.37 981.805Q342.174 845.326 261.359 761.131q-80.816-84.196-123.272-140.25-42.457-56.055-55.055-96.848-12.597-40.794-12.597-89.468 0-94.152 65.076-159.826 65.076-65.674 158.989-65.674 46.913 0 90.348 17.696 43.435 17.695 77.869 49.891L404.065 496h116.218l-46.24 386.826 123.413-425.391H479.043l70.522-219.892q26.674-14.478 55.968-21.478 29.293-7 59.967-7 93.913 0 159.109 65.674 65.196 65.674 65.196 159.826 0 47.435-12.457 87.609-12.457 40.174-55.13 96.848-42.674 56.674-123.946 141.109Q617 844.565 478.37 981.805Z"
      />
    </svg>
  </button>
</template>

<style scoped lang="scss">
@use "@/styles/colors" as colors;

.like {
  width: 32px;
  height: 32px;
  cursor: pointer;

  svg {
    width: 100%;
    height: 100%;
    fill: colors.$lightgray;
  }

  &:hover svg {
    fill: colors.$subtext;
  }

  &.active svg {
    fill: colors.$liked;
  }

  &__break {
    display: none;
  }

  &.active:hover &__filled {
    display: none;
  }

  &.active:hover &__break {
    display: block;
  }
}
</style>
